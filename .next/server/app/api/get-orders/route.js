"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/get-orders/route";
exports.ids = ["app/api/get-orders/route"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fget-orders%2Froute&page=%2Fapi%2Fget-orders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-orders%2Froute.js&appDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fget-orders%2Froute&page=%2Fapi%2Fget-orders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-orders%2Froute.js&appDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var _Users_siddharthsushill_Desktop_zomato_analyzer_app_api_get_orders_route_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/api/get-orders/route.js */ \"(rsc)/./app/api/get-orders/route.js\");\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/get-orders/route\",\n        pathname: \"/api/get-orders\",\n        filename: \"route\",\n        bundlePath: \"app/api/get-orders/route\"\n    },\n    resolvedPagePath: \"/Users/siddharthsushill/Desktop/zomato-analyzer/app/api/get-orders/route.js\",\n    nextConfigOutput,\n    userland: _Users_siddharthsushill_Desktop_zomato_analyzer_app_api_get_orders_route_js__WEBPACK_IMPORTED_MODULE_2__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/get-orders/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZXQtb3JkZXJzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZnZXQtb3JkZXJzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZ2V0LW9yZGVycyUyRnJvdXRlLmpzJmFwcERpcj0lMkZVc2VycyUyRnNpZGRoYXJ0aHN1c2hpbGwlMkZEZXNrdG9wJTJGem9tYXRvLWFuYWx5emVyJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnNpZGRoYXJ0aHN1c2hpbGwlMkZEZXNrdG9wJTJGem9tYXRvLWFuYWx5emVyJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUN5QztBQUN4RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNpSjs7QUFFakoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly96b21hdG8tYW5hbHl6ZXIvP2U5YTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3NpZGRoYXJ0aHN1c2hpbGwvRGVza3RvcC96b21hdG8tYW5hbHl6ZXIvYXBwL2FwaS9nZXQtb3JkZXJzL3JvdXRlLmpzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nZXQtb3JkZXJzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2V0LW9yZGVyc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2V0LW9yZGVycy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9zaWRkaGFydGhzdXNoaWxsL0Rlc2t0b3Avem9tYXRvLWFuYWx5emVyL2FwcC9hcGkvZ2V0LW9yZGVycy9yb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9nZXQtb3JkZXJzL3JvdXRlXCI7XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fget-orders%2Froute&page=%2Fapi%2Fget-orders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-orders%2Froute.js&appDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/get-orders/route.js":
/*!*************************************!*\
  !*** ./app/api/get-orders/route.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/db */ \"(rsc)/./utils/db.js\");\n\nasync function GET() {\n    try {\n        const db = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_0__.connectDB)();\n        const orders = await db.collection(\"orders\").find().sort({\n            date: -1\n        }).toArray();\n        if (orders.length === 0) {\n            return Response.json({\n                monthly: [],\n                restaurantPie: [],\n                topItems: [],\n                deliveryStats: {\n                    total: 0,\n                    average: 0\n                },\n                discountStats: {\n                    total: 0,\n                    average: 0\n                },\n                peakTimes: {},\n                orderHistory: [],\n                summary: {\n                    totalSpent: 0,\n                    totalOrders: 0,\n                    averageOrderValue: 0,\n                    totalDeliveryFees: 0,\n                    totalDiscounts: 0\n                }\n            });\n        }\n        // 1. Monthly Spending Trend\n        const monthly = {};\n        orders.forEach((o)=>{\n            const key = new Date(o.date).toISOString().slice(0, 7);\n            monthly[key] = (monthly[key] || 0) + o.amount;\n        });\n        const monthlyArr = Object.keys(monthly).sort().map((m)=>({\n                month: m,\n                amount: parseFloat(monthly[m].toFixed(2)),\n                displayMonth: new Date(m + \"-01\").toLocaleDateString(\"en-US\", {\n                    month: \"short\",\n                    year: \"numeric\"\n                })\n            }));\n        // 2. Restaurant-wise Breakdown\n        const restaurants = {};\n        const restaurantOrders = {};\n        orders.forEach((o)=>{\n            restaurants[o.restaurant] = (restaurants[o.restaurant] || 0) + o.amount;\n            restaurantOrders[o.restaurant] = (restaurantOrders[o.restaurant] || 0) + 1;\n        });\n        const restaurantPie = Object.keys(restaurants).map((r)=>({\n                name: r,\n                value: parseFloat(restaurants[r].toFixed(2)),\n                orders: restaurantOrders[r]\n            })).sort((a, b)=>b.value - a.value).slice(0, 10); // Top 10 restaurants\n        // 3. Top Items Ordered\n        const itemsMap = {};\n        orders.forEach((o)=>{\n            (o.items || []).forEach((item)=>{\n                const key = item.name;\n                if (!itemsMap[key]) {\n                    itemsMap[key] = {\n                        name: key,\n                        count: 0,\n                        totalSpent: 0\n                    };\n                }\n                itemsMap[key].count += item.quantity;\n                itemsMap[key].totalSpent += item.price * item.quantity;\n            });\n        });\n        const topItems = Object.values(itemsMap).sort((a, b)=>b.count - a.count).slice(0, 15).map((item)=>({\n                ...item,\n                totalSpent: parseFloat(item.totalSpent.toFixed(2))\n            }));\n        // 4. Delivery Fee Statistics\n        const deliveryFees = orders.map((o)=>o.deliveryFee || 0).filter((f)=>f > 0);\n        const deliveryStats = {\n            total: parseFloat(deliveryFees.reduce((sum, f)=>sum + f, 0).toFixed(2)),\n            average: deliveryFees.length > 0 ? parseFloat((deliveryFees.reduce((sum, f)=>sum + f, 0) / deliveryFees.length).toFixed(2)) : 0,\n            count: deliveryFees.length\n        };\n        // 5. Discount Statistics\n        const discounts = orders.map((o)=>o.discount || 0).filter((d)=>d > 0);\n        const discountStats = {\n            total: parseFloat(discounts.reduce((sum, d)=>sum + d, 0).toFixed(2)),\n            average: discounts.length > 0 ? parseFloat((discounts.reduce((sum, d)=>sum + d, 0) / discounts.length).toFixed(2)) : 0,\n            count: discounts.length\n        };\n        // 6. Peak Ordering Times (Hour of day)\n        const hourCounts = {};\n        const dayCounts = {};\n        orders.forEach((o)=>{\n            const date = new Date(o.date);\n            const hour = date.getHours();\n            const day = date.toLocaleDateString(\"en-US\", {\n                weekday: \"short\"\n            });\n            hourCounts[hour] = (hourCounts[hour] || 0) + 1;\n            dayCounts[day] = (dayCounts[day] || 0) + 1;\n        });\n        const peakHours = Object.keys(hourCounts).map((h)=>({\n                hour: parseInt(h),\n                displayHour: `${h}:00`,\n                orders: hourCounts[h]\n            })).sort((a, b)=>a.hour - b.hour);\n        const peakDays = [\n            \"Mon\",\n            \"Tue\",\n            \"Wed\",\n            \"Thu\",\n            \"Fri\",\n            \"Sat\",\n            \"Sun\"\n        ].map((day)=>({\n                day,\n                orders: dayCounts[day] || 0\n            }));\n        // 7. Category/Time-based Heatmap Data\n        const heatmapData = [];\n        const days = [\n            \"Mon\",\n            \"Tue\",\n            \"Wed\",\n            \"Thu\",\n            \"Fri\",\n            \"Sat\",\n            \"Sun\"\n        ];\n        for(let hour = 0; hour < 24; hour++){\n            days.forEach((day)=>{\n                const count = orders.filter((o)=>{\n                    const d = new Date(o.date);\n                    return d.getHours() === hour && d.toLocaleDateString(\"en-US\", {\n                        weekday: \"short\"\n                    }) === day;\n                }).length;\n                if (count > 0) {\n                    heatmapData.push({\n                        day,\n                        hour,\n                        count\n                    });\n                }\n            });\n        }\n        // 8. Order History (Last 50 orders)\n        const orderHistory = orders.slice(0, 50).map((o)=>({\n                id: o._id.toString(),\n                date: new Date(o.date).toLocaleDateString(\"en-IN\", {\n                    year: \"numeric\",\n                    month: \"short\",\n                    day: \"numeric\",\n                    hour: \"2-digit\",\n                    minute: \"2-digit\"\n                }),\n                restaurant: o.restaurant,\n                items: (o.items || []).map((i)=>`${i.quantity}x ${i.name}`).join(\", \") || \"N/A\",\n                amount: parseFloat(o.amount.toFixed(2)),\n                deliveryFee: parseFloat((o.deliveryFee || 0).toFixed(2)),\n                discount: parseFloat((o.discount || 0).toFixed(2)),\n                taxes: parseFloat((o.taxes || 0).toFixed(2))\n            }));\n        // 9. Summary Statistics\n        const totalSpent = orders.reduce((sum, o)=>sum + o.amount, 0);\n        const summary = {\n            totalSpent: parseFloat(totalSpent.toFixed(2)),\n            totalOrders: orders.length,\n            averageOrderValue: parseFloat((totalSpent / orders.length).toFixed(2)),\n            totalDeliveryFees: deliveryStats.total,\n            totalDiscounts: discountStats.total,\n            totalTaxes: parseFloat(orders.reduce((sum, o)=>sum + (o.taxes || 0), 0).toFixed(2)),\n            mostOrderedRestaurant: restaurantPie[0]?.name || \"N/A\",\n            favoriteItem: topItems[0]?.name || \"N/A\"\n        };\n        // 10. Spending Trends (Last 6 months)\n        const last6Months = monthlyArr.slice(-6);\n        return Response.json({\n            monthly: monthlyArr,\n            restaurantPie,\n            restaurantBar: restaurantPie,\n            topItems,\n            deliveryStats,\n            discountStats,\n            peakHours,\n            peakDays,\n            heatmapData,\n            orderHistory,\n            summary,\n            last6Months\n        });\n    } catch (error) {\n        console.error(\"Get orders error:\", error);\n        return Response.json({\n            error: error.message,\n            details: \"Failed to retrieve analytics data\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q25CQyxTQUFTc0I7WUFDVHJCO1lBQ0FpRixlQUFlakY7WUFDZkM7WUFDQUM7WUFDQUc7WUFDQXlEO1lBQ0FJO1lBQ0FDO1lBQ0E1RDtZQUNBQztZQUNBd0U7UUFDRjtJQUVGLEVBQUUsT0FBT0UsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMscUJBQXFCQTtRQUNuQyxPQUFPckYsU0FBU0MsSUFBSSxDQUFDO1lBQ25Cb0YsT0FBT0EsTUFBTUUsT0FBTztZQUNwQkMsU0FBUztRQUNYLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ25CO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly96b21hdG8tYW5hbHl6ZXIvLi9hcHAvYXBpL2dldC1vcmRlcnMvcm91dGUuanM/Y2U0NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb25uZWN0REIgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvZGJcIjtcblxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICB0cnkge1xuICAgIGNvbnN0IGRiID0gYXdhaXQgY29ubmVjdERCKCk7XG4gICAgY29uc3Qgb3JkZXJzID0gYXdhaXQgZGIuY29sbGVjdGlvbihcIm9yZGVyc1wiKS5maW5kKCkuc29ydCh7IGRhdGU6IC0xIH0pLnRvQXJyYXkoKTtcblxuICAgIGlmIChvcmRlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gUmVzcG9uc2UuanNvbih7XG4gICAgICAgIG1vbnRobHk6IFtdLFxuICAgICAgICByZXN0YXVyYW50UGllOiBbXSxcbiAgICAgICAgdG9wSXRlbXM6IFtdLFxuICAgICAgICBkZWxpdmVyeVN0YXRzOiB7IHRvdGFsOiAwLCBhdmVyYWdlOiAwIH0sXG4gICAgICAgIGRpc2NvdW50U3RhdHM6IHsgdG90YWw6IDAsIGF2ZXJhZ2U6IDAgfSxcbiAgICAgICAgcGVha1RpbWVzOiB7fSxcbiAgICAgICAgb3JkZXJIaXN0b3J5OiBbXSxcbiAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgIHRvdGFsU3BlbnQ6IDAsXG4gICAgICAgICAgdG90YWxPcmRlcnM6IDAsXG4gICAgICAgICAgYXZlcmFnZU9yZGVyVmFsdWU6IDAsXG4gICAgICAgICAgdG90YWxEZWxpdmVyeUZlZXM6IDAsXG4gICAgICAgICAgdG90YWxEaXNjb3VudHM6IDBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gMS4gTW9udGhseSBTcGVuZGluZyBUcmVuZFxuICAgIGNvbnN0IG1vbnRobHkgPSB7fTtcbiAgICBvcmRlcnMuZm9yRWFjaChvID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IG5ldyBEYXRlKG8uZGF0ZSkudG9JU09TdHJpbmcoKS5zbGljZSgwLCA3KTtcbiAgICAgIG1vbnRobHlba2V5XSA9IChtb250aGx5W2tleV0gfHwgMCkgKyBvLmFtb3VudDtcbiAgICB9KTtcbiAgICBjb25zdCBtb250aGx5QXJyID0gT2JqZWN0LmtleXMobW9udGhseSlcbiAgICAgIC5zb3J0KClcbiAgICAgIC5tYXAobSA9PiAoeyBcbiAgICAgICAgbW9udGg6IG0sIFxuICAgICAgICBhbW91bnQ6IHBhcnNlRmxvYXQobW9udGhseVttXS50b0ZpeGVkKDIpKSxcbiAgICAgICAgZGlzcGxheU1vbnRoOiBuZXcgRGF0ZShtICsgXCItMDFcIikudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi1VUycsIHsgbW9udGg6ICdzaG9ydCcsIHllYXI6ICdudW1lcmljJyB9KVxuICAgICAgfSkpO1xuXG4gICAgLy8gMi4gUmVzdGF1cmFudC13aXNlIEJyZWFrZG93blxuICAgIGNvbnN0IHJlc3RhdXJhbnRzID0ge307XG4gICAgY29uc3QgcmVzdGF1cmFudE9yZGVycyA9IHt9O1xuICAgIG9yZGVycy5mb3JFYWNoKG8gPT4ge1xuICAgICAgcmVzdGF1cmFudHNbby5yZXN0YXVyYW50XSA9IChyZXN0YXVyYW50c1tvLnJlc3RhdXJhbnRdIHx8IDApICsgby5hbW91bnQ7XG4gICAgICByZXN0YXVyYW50T3JkZXJzW28ucmVzdGF1cmFudF0gPSAocmVzdGF1cmFudE9yZGVyc1tvLnJlc3RhdXJhbnRdIHx8IDApICsgMTtcbiAgICB9KTtcbiAgICBjb25zdCByZXN0YXVyYW50UGllID0gT2JqZWN0LmtleXMocmVzdGF1cmFudHMpXG4gICAgICAubWFwKHIgPT4gKHsgXG4gICAgICAgIG5hbWU6IHIsIFxuICAgICAgICB2YWx1ZTogcGFyc2VGbG9hdChyZXN0YXVyYW50c1tyXS50b0ZpeGVkKDIpKSxcbiAgICAgICAgb3JkZXJzOiByZXN0YXVyYW50T3JkZXJzW3JdXG4gICAgICB9KSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnZhbHVlIC0gYS52YWx1ZSlcbiAgICAgIC5zbGljZSgwLCAxMCk7IC8vIFRvcCAxMCByZXN0YXVyYW50c1xuXG4gICAgLy8gMy4gVG9wIEl0ZW1zIE9yZGVyZWRcbiAgICBjb25zdCBpdGVtc01hcCA9IHt9O1xuICAgIG9yZGVycy5mb3JFYWNoKG8gPT4ge1xuICAgICAgKG8uaXRlbXMgfHwgW10pLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IGl0ZW0ubmFtZTtcbiAgICAgICAgaWYgKCFpdGVtc01hcFtrZXldKSB7XG4gICAgICAgICAgaXRlbXNNYXBba2V5XSA9IHsgbmFtZToga2V5LCBjb3VudDogMCwgdG90YWxTcGVudDogMCB9O1xuICAgICAgICB9XG4gICAgICAgIGl0ZW1zTWFwW2tleV0uY291bnQgKz0gaXRlbS5xdWFudGl0eTtcbiAgICAgICAgaXRlbXNNYXBba2V5XS50b3RhbFNwZW50ICs9IGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5O1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY29uc3QgdG9wSXRlbXMgPSBPYmplY3QudmFsdWVzKGl0ZW1zTWFwKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIuY291bnQgLSBhLmNvdW50KVxuICAgICAgLnNsaWNlKDAsIDE1KVxuICAgICAgLm1hcChpdGVtID0+ICh7XG4gICAgICAgIC4uLml0ZW0sXG4gICAgICAgIHRvdGFsU3BlbnQ6IHBhcnNlRmxvYXQoaXRlbS50b3RhbFNwZW50LnRvRml4ZWQoMikpXG4gICAgICB9KSk7XG5cbiAgICAvLyA0LiBEZWxpdmVyeSBGZWUgU3RhdGlzdGljc1xuICAgIGNvbnN0IGRlbGl2ZXJ5RmVlcyA9IG9yZGVycy5tYXAobyA9PiBvLmRlbGl2ZXJ5RmVlIHx8IDApLmZpbHRlcihmID0+IGYgPiAwKTtcbiAgICBjb25zdCBkZWxpdmVyeVN0YXRzID0ge1xuICAgICAgdG90YWw6IHBhcnNlRmxvYXQoZGVsaXZlcnlGZWVzLnJlZHVjZSgoc3VtLCBmKSA9PiBzdW0gKyBmLCAwKS50b0ZpeGVkKDIpKSxcbiAgICAgIGF2ZXJhZ2U6IGRlbGl2ZXJ5RmVlcy5sZW5ndGggPiAwIFxuICAgICAgICA/IHBhcnNlRmxvYXQoKGRlbGl2ZXJ5RmVlcy5yZWR1Y2UoKHN1bSwgZikgPT4gc3VtICsgZiwgMCkgLyBkZWxpdmVyeUZlZXMubGVuZ3RoKS50b0ZpeGVkKDIpKVxuICAgICAgICA6IDAsXG4gICAgICBjb3VudDogZGVsaXZlcnlGZWVzLmxlbmd0aFxuICAgIH07XG5cbiAgICAvLyA1LiBEaXNjb3VudCBTdGF0aXN0aWNzXG4gICAgY29uc3QgZGlzY291bnRzID0gb3JkZXJzLm1hcChvID0+IG8uZGlzY291bnQgfHwgMCkuZmlsdGVyKGQgPT4gZCA+IDApO1xuICAgIGNvbnN0IGRpc2NvdW50U3RhdHMgPSB7XG4gICAgICB0b3RhbDogcGFyc2VGbG9hdChkaXNjb3VudHMucmVkdWNlKChzdW0sIGQpID0+IHN1bSArIGQsIDApLnRvRml4ZWQoMikpLFxuICAgICAgYXZlcmFnZTogZGlzY291bnRzLmxlbmd0aCA+IDBcbiAgICAgICAgPyBwYXJzZUZsb2F0KChkaXNjb3VudHMucmVkdWNlKChzdW0sIGQpID0+IHN1bSArIGQsIDApIC8gZGlzY291bnRzLmxlbmd0aCkudG9GaXhlZCgyKSlcbiAgICAgICAgOiAwLFxuICAgICAgY291bnQ6IGRpc2NvdW50cy5sZW5ndGhcbiAgICB9O1xuXG4gICAgLy8gNi4gUGVhayBPcmRlcmluZyBUaW1lcyAoSG91ciBvZiBkYXkpXG4gICAgY29uc3QgaG91ckNvdW50cyA9IHt9O1xuICAgIGNvbnN0IGRheUNvdW50cyA9IHt9O1xuICAgIG9yZGVycy5mb3JFYWNoKG8gPT4ge1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKG8uZGF0ZSk7XG4gICAgICBjb25zdCBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgY29uc3QgZGF5ID0gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywgeyB3ZWVrZGF5OiAnc2hvcnQnIH0pO1xuICAgICAgXG4gICAgICBob3VyQ291bnRzW2hvdXJdID0gKGhvdXJDb3VudHNbaG91cl0gfHwgMCkgKyAxO1xuICAgICAgZGF5Q291bnRzW2RheV0gPSAoZGF5Q291bnRzW2RheV0gfHwgMCkgKyAxO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcGVha0hvdXJzID0gT2JqZWN0LmtleXMoaG91ckNvdW50cylcbiAgICAgIC5tYXAoaCA9PiAoe1xuICAgICAgICBob3VyOiBwYXJzZUludChoKSxcbiAgICAgICAgZGlzcGxheUhvdXI6IGAke2h9OjAwYCxcbiAgICAgICAgb3JkZXJzOiBob3VyQ291bnRzW2hdXG4gICAgICB9KSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmhvdXIgLSBiLmhvdXIpO1xuXG4gICAgY29uc3QgcGVha0RheXMgPSBbJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodScsICdGcmknLCAnU2F0JywgJ1N1biddLm1hcChkYXkgPT4gKHtcbiAgICAgIGRheSxcbiAgICAgIG9yZGVyczogZGF5Q291bnRzW2RheV0gfHwgMFxuICAgIH0pKTtcblxuICAgIC8vIDcuIENhdGVnb3J5L1RpbWUtYmFzZWQgSGVhdG1hcCBEYXRhXG4gICAgY29uc3QgaGVhdG1hcERhdGEgPSBbXTtcbiAgICBjb25zdCBkYXlzID0gWydNb24nLCAnVHVlJywgJ1dlZCcsICdUaHUnLCAnRnJpJywgJ1NhdCcsICdTdW4nXTtcbiAgICBmb3IgKGxldCBob3VyID0gMDsgaG91ciA8IDI0OyBob3VyKyspIHtcbiAgICAgIGRheXMuZm9yRWFjaChkYXkgPT4ge1xuICAgICAgICBjb25zdCBjb3VudCA9IG9yZGVycy5maWx0ZXIobyA9PiB7XG4gICAgICAgICAgY29uc3QgZCA9IG5ldyBEYXRlKG8uZGF0ZSk7XG4gICAgICAgICAgcmV0dXJuIGQuZ2V0SG91cnMoKSA9PT0gaG91ciAmJiBcbiAgICAgICAgICAgICAgICAgZC50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywgeyB3ZWVrZGF5OiAnc2hvcnQnIH0pID09PSBkYXk7XG4gICAgICAgIH0pLmxlbmd0aDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb3VudCA+IDApIHtcbiAgICAgICAgICBoZWF0bWFwRGF0YS5wdXNoKHsgZGF5LCBob3VyLCBjb3VudCB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gOC4gT3JkZXIgSGlzdG9yeSAoTGFzdCA1MCBvcmRlcnMpXG4gICAgY29uc3Qgb3JkZXJIaXN0b3J5ID0gb3JkZXJzLnNsaWNlKDAsIDUwKS5tYXAobyA9PiAoe1xuICAgICAgaWQ6IG8uX2lkLnRvU3RyaW5nKCksXG4gICAgICBkYXRlOiBuZXcgRGF0ZShvLmRhdGUpLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tSU4nLCB7IFxuICAgICAgICB5ZWFyOiAnbnVtZXJpYycsIFxuICAgICAgICBtb250aDogJ3Nob3J0JywgXG4gICAgICAgIGRheTogJ251bWVyaWMnLFxuICAgICAgICBob3VyOiAnMi1kaWdpdCcsXG4gICAgICAgIG1pbnV0ZTogJzItZGlnaXQnXG4gICAgICB9KSxcbiAgICAgIHJlc3RhdXJhbnQ6IG8ucmVzdGF1cmFudCxcbiAgICAgIGl0ZW1zOiAoby5pdGVtcyB8fCBbXSkubWFwKGkgPT4gYCR7aS5xdWFudGl0eX14ICR7aS5uYW1lfWApLmpvaW4oXCIsIFwiKSB8fCBcIk4vQVwiLFxuICAgICAgYW1vdW50OiBwYXJzZUZsb2F0KG8uYW1vdW50LnRvRml4ZWQoMikpLFxuICAgICAgZGVsaXZlcnlGZWU6IHBhcnNlRmxvYXQoKG8uZGVsaXZlcnlGZWUgfHwgMCkudG9GaXhlZCgyKSksXG4gICAgICBkaXNjb3VudDogcGFyc2VGbG9hdCgoby5kaXNjb3VudCB8fCAwKS50b0ZpeGVkKDIpKSxcbiAgICAgIHRheGVzOiBwYXJzZUZsb2F0KChvLnRheGVzIHx8IDApLnRvRml4ZWQoMikpXG4gICAgfSkpO1xuXG4gICAgLy8gOS4gU3VtbWFyeSBTdGF0aXN0aWNzXG4gICAgY29uc3QgdG90YWxTcGVudCA9IG9yZGVycy5yZWR1Y2UoKHN1bSwgbykgPT4gc3VtICsgby5hbW91bnQsIDApO1xuICAgIGNvbnN0IHN1bW1hcnkgPSB7XG4gICAgICB0b3RhbFNwZW50OiBwYXJzZUZsb2F0KHRvdGFsU3BlbnQudG9GaXhlZCgyKSksXG4gICAgICB0b3RhbE9yZGVyczogb3JkZXJzLmxlbmd0aCxcbiAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiBwYXJzZUZsb2F0KCh0b3RhbFNwZW50IC8gb3JkZXJzLmxlbmd0aCkudG9GaXhlZCgyKSksXG4gICAgICB0b3RhbERlbGl2ZXJ5RmVlczogZGVsaXZlcnlTdGF0cy50b3RhbCxcbiAgICAgIHRvdGFsRGlzY291bnRzOiBkaXNjb3VudFN0YXRzLnRvdGFsLFxuICAgICAgdG90YWxUYXhlczogcGFyc2VGbG9hdChvcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIChvLnRheGVzIHx8IDApLCAwKS50b0ZpeGVkKDIpKSxcbiAgICAgIG1vc3RPcmRlcmVkUmVzdGF1cmFudDogcmVzdGF1cmFudFBpZVswXT8ubmFtZSB8fCBcIk4vQVwiLFxuICAgICAgZmF2b3JpdGVJdGVtOiB0b3BJdGVtc1swXT8ubmFtZSB8fCBcIk4vQVwiXG4gICAgfTtcblxuICAgIC8vIDEwLiBTcGVuZGluZyBUcmVuZHMgKExhc3QgNiBtb250aHMpXG4gICAgY29uc3QgbGFzdDZNb250aHMgPSBtb250aGx5QXJyLnNsaWNlKC02KTtcblxuICAgIHJldHVybiBSZXNwb25zZS5qc29uKHtcbiAgICAgIG1vbnRobHk6IG1vbnRobHlBcnIsXG4gICAgICByZXN0YXVyYW50UGllLFxuICAgICAgcmVzdGF1cmFudEJhcjogcmVzdGF1cmFudFBpZSwgLy8gU2FtZSBkYXRhIGZvciBiYXIgY2hhcnRcbiAgICAgIHRvcEl0ZW1zLFxuICAgICAgZGVsaXZlcnlTdGF0cyxcbiAgICAgIGRpc2NvdW50U3RhdHMsXG4gICAgICBwZWFrSG91cnMsXG4gICAgICBwZWFrRGF5cyxcbiAgICAgIGhlYXRtYXBEYXRhLFxuICAgICAgb3JkZXJIaXN0b3J5LFxuICAgICAgc3VtbWFyeSxcbiAgICAgIGxhc3Q2TW9udGhzXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiR2V0IG9yZGVycyBlcnJvcjpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBSZXNwb25zZS5qc29uKHsgXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIGRldGFpbHM6IFwiRmFpbGVkIHRvIHJldHJpZXZlIGFuYWx5dGljcyBkYXRhXCJcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbImNvbm5lY3REQiIsIkdFVCIsImRiIiwib3JkZXJzIiwiY29sbGVjdGlvbiIsImZpbmQiLCJzb3J0IiwiZGF0ZSIsInRvQXJyYXkiLCJsZW5ndGgiLCJSZXNwb25zZSIsImpzb24iLCJtb250aGx5IiwicmVzdGF1cmFudFBpZSIsInRvcEl0ZW1zIiwiZGVsaXZlcnlTdGF0cyIsInRvdGFsIiwiYXZlcmFnZSIsImRpc2NvdW50U3RhdHMiLCJwZWFrVGltZXMiLCJvcmRlckhpc3RvcnkiLCJzdW1tYXJ5IiwidG90YWxTcGVudCIsInRvdGFsT3JkZXJzIiwiYXZlcmFnZU9yZGVyVmFsdWUiLCJ0b3RhbERlbGl2ZXJ5RmVlcyIsInRvdGFsRGlzY291bnRzIiwiZm9yRWFjaCIsIm8iLCJrZXkiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzbGljZSIsImFtb3VudCIsIm1vbnRobHlBcnIiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwibSIsIm1vbnRoIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJkaXNwbGF5TW9udGgiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJ5ZWFyIiwicmVzdGF1cmFudHMiLCJyZXN0YXVyYW50T3JkZXJzIiwicmVzdGF1cmFudCIsInIiLCJuYW1lIiwidmFsdWUiLCJhIiwiYiIsIml0ZW1zTWFwIiwiaXRlbXMiLCJpdGVtIiwiY291bnQiLCJxdWFudGl0eSIsInByaWNlIiwidmFsdWVzIiwiZGVsaXZlcnlGZWVzIiwiZGVsaXZlcnlGZWUiLCJmaWx0ZXIiLCJmIiwicmVkdWNlIiwic3VtIiwiZGlzY291bnRzIiwiZGlzY291bnQiLCJkIiwiaG91ckNvdW50cyIsImRheUNvdW50cyIsImhvdXIiLCJnZXRIb3VycyIsImRheSIsIndlZWtkYXkiLCJwZWFrSG91cnMiLCJoIiwicGFyc2VJbnQiLCJkaXNwbGF5SG91ciIsInBlYWtEYXlzIiwiaGVhdG1hcERhdGEiLCJkYXlzIiwicHVzaCIsImlkIiwiX2lkIiwidG9TdHJpbmciLCJtaW51dGUiLCJpIiwiam9pbiIsInRheGVzIiwidG90YWxUYXhlcyIsIm1vc3RPcmRlcmVkUmVzdGF1cmFudCIsImZhdm9yaXRlSXRlbSIsImxhc3Q2TW9udGhzIiwicmVzdGF1cmFudEJhciIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/get-orders/route.js\n");

/***/ }),

/***/ "(rsc)/./utils/db.js":
/*!*********************!*\
  !*** ./utils/db.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectDB: () => (/* binding */ connectDB)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nlet client = null;\nlet db = null;\nasync function connectDB() {\n    try {\n        if (db) {\n            return db;\n        }\n        if (!process.env.MONGO_URI) {\n            throw new Error(\"MONGO_URI environment variable is not set\");\n        }\n        if (!client) {\n            client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(process.env.MONGO_URI, {\n                useNewUrlParser: true,\n                useUnifiedTopology: true\n            });\n        }\n        await client.connect();\n        db = client.db(\"zomato_analyzer\");\n        // Create indexes for better performance\n        await db.collection(\"orders\").createIndex({\n            emailId: 1\n        }, {\n            unique: true\n        });\n        await db.collection(\"orders\").createIndex({\n            date: -1\n        });\n        await db.collection(\"orders\").createIndex({\n            restaurant: 1\n        });\n        console.log(\"✅ MongoDB connected successfully\");\n        return db;\n    } catch (error) {\n        console.error(\"❌ MongoDB connection error:\", error);\n        throw error;\n    }\n}\n// Graceful shutdown\nprocess.on(\"SIGINT\", async ()=>{\n    if (client) {\n        await client.close();\n        console.log(\"MongoDB connection closed\");\n        process.exit(0);\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0M7QUFFdEMsSUFBSUMsU0FBUztBQUNiLElBQUlDLEtBQUs7QUFFRixlQUFlQztJQUNwQixJQUFJO1FBQ0YsSUFBSUQsSUFBSTtZQUNOLE9BQU9BO1FBQ1Q7UUFFQSxJQUFJLENBQUNFLFFBQVFDLEdBQUcsQ0FBQ0MsU0FBUyxFQUFFO1lBQzFCLE1BQU0sSUFBSUMsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ04sUUFBUTtZQUNYQSxTQUFTLElBQUlELGdEQUFXQSxDQUFDSSxRQUFRQyxHQUFHLENBQUNDLFNBQVMsRUFBRTtnQkFDOUNFLGlCQUFpQjtnQkFDakJDLG9CQUFvQjtZQUN0QjtRQUNGO1FBRUEsTUFBTVIsT0FBT1MsT0FBTztRQUNwQlIsS0FBS0QsT0FBT0MsRUFBRSxDQUFDO1FBRWYsd0NBQXdDO1FBQ3hDLE1BQU1BLEdBQUdTLFVBQVUsQ0FBQyxVQUFVQyxXQUFXLENBQUM7WUFBRUMsU0FBUztRQUFFLEdBQUc7WUFBRUMsUUFBUTtRQUFLO1FBQ3pFLE1BQU1aLEdBQUdTLFVBQVUsQ0FBQyxVQUFVQyxXQUFXLENBQUM7WUFBRUcsTUFBTSxDQUFDO1FBQUU7UUFDckQsTUFBTWIsR0FBR1MsVUFBVSxDQUFDLFVBQVVDLFdBQVcsQ0FBQztZQUFFSSxZQUFZO1FBQUU7UUFFMURDLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9oQjtJQUVULEVBQUUsT0FBT2lCLE9BQU87UUFDZEYsUUFBUUUsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsTUFBTUE7SUFDUjtBQUNGO0FBRUEsb0JBQW9CO0FBQ3BCZixRQUFRZ0IsRUFBRSxDQUFDLFVBQVU7SUFDbkIsSUFBSW5CLFFBQVE7UUFDVixNQUFNQSxPQUFPb0IsS0FBSztRQUNsQkosUUFBUUMsR0FBRyxDQUFDO1FBQ1pkLFFBQVFrQixJQUFJLENBQUM7SUFDZjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vem9tYXRvLWFuYWx5emVyLy4vdXRpbHMvZGIuanM/N2NiMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNb25nb0NsaWVudCB9IGZyb20gXCJtb25nb2RiXCI7XG5cbmxldCBjbGllbnQgPSBudWxsO1xubGV0IGRiID0gbnVsbDtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3REQigpIHtcbiAgdHJ5IHtcbiAgICBpZiAoZGIpIHtcbiAgICAgIHJldHVybiBkYjtcbiAgICB9XG5cbiAgICBpZiAoIXByb2Nlc3MuZW52Lk1PTkdPX1VSSSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTU9OR09fVVJJIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG5vdCBzZXRcIik7XG4gICAgfVxuXG4gICAgaWYgKCFjbGllbnQpIHtcbiAgICAgIGNsaWVudCA9IG5ldyBNb25nb0NsaWVudChwcm9jZXNzLmVudi5NT05HT19VUkksIHtcbiAgICAgICAgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLFxuICAgICAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBhd2FpdCBjbGllbnQuY29ubmVjdCgpO1xuICAgIGRiID0gY2xpZW50LmRiKFwiem9tYXRvX2FuYWx5emVyXCIpO1xuXG4gICAgLy8gQ3JlYXRlIGluZGV4ZXMgZm9yIGJldHRlciBwZXJmb3JtYW5jZVxuICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJvcmRlcnNcIikuY3JlYXRlSW5kZXgoeyBlbWFpbElkOiAxIH0sIHsgdW5pcXVlOiB0cnVlIH0pO1xuICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJvcmRlcnNcIikuY3JlYXRlSW5kZXgoeyBkYXRlOiAtMSB9KTtcbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKFwib3JkZXJzXCIpLmNyZWF0ZUluZGV4KHsgcmVzdGF1cmFudDogMSB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIE1vbmdvREIgY29ubmVjdGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICByZXR1cm4gZGI7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIE1vbmdvREIgY29ubmVjdGlvbiBlcnJvcjpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8vIEdyYWNlZnVsIHNodXRkb3duXG5wcm9jZXNzLm9uKFwiU0lHSU5UXCIsIGFzeW5jICgpID0+IHtcbiAgaWYgKGNsaWVudCkge1xuICAgIGF3YWl0IGNsaWVudC5jbG9zZSgpO1xuICAgIGNvbnNvbGUubG9nKFwiTW9uZ29EQiBjb25uZWN0aW9uIGNsb3NlZFwiKTtcbiAgICBwcm9jZXNzLmV4aXQoMCk7XG4gIH1cbn0pOyJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsImNsaWVudCIsImRiIiwiY29ubmVjdERCIiwicHJvY2VzcyIsImVudiIsIk1PTkdPX1VSSSIsIkVycm9yIiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwiY29ubmVjdCIsImNvbGxlY3Rpb24iLCJjcmVhdGVJbmRleCIsImVtYWlsSWQiLCJ1bmlxdWUiLCJkYXRlIiwicmVzdGF1cmFudCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIm9uIiwiY2xvc2UiLCJleGl0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fget-orders%2Froute&page=%2Fapi%2Fget-orders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-orders%2Froute.js&appDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsiddharthsushill%2FDesktop%2Fzomato-analyzer&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();